<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="A modern habit and daily task tracker with time blocks, streaks, and analytics">

    <!-- PWA Meta Tags -->
    <meta name="theme-color" content="#6366f1">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="apple-mobile-web-app-title" content="Habit Tracker">
    <link rel="manifest" href="/manifest.json">
    <link rel="apple-touch-icon" href="/icon-192.png">

    <title>Habit & Task Tracker</title>
    <link rel="stylesheet" href="styles/main.css">
    <link rel="stylesheet" href="styles/focus-mode.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
</head>

<body>
    <!-- Navigation Bar -->
    <nav class="navbar">
        <div class="nav-container">
            <div class="nav-brand">
                <i class="fa-solid fa-check-double"></i>
                <span>Habit Tracker</span>
            </div>
            <div class="nav-links">
                <button class="nav-btn active" data-view="dashboard">
                    <i class="fa-solid fa-home"></i>
                    <span>Dashboard</span>
                </button>
                <button class="nav-btn" data-view="habits">
                    <i class="fa-solid fa-star"></i>
                    <span>Habits</span>
                </button>
                <button class="nav-btn" data-view="analytics">
                    <i class="fa-solid fa-chart-line"></i>
                    <span>Analytics</span>
                </button>
                <button class="nav-btn" data-view="goals">
                    <i class="fa-solid fa-bullseye"></i>
                    <span>Goals</span>
                </button>
                <button class="nav-btn" data-view="events">
                    <i class="fa-solid fa-calendar-days"></i>
                    <span>Events</span>
                </button>
            </div>
            <div class="user-profile" id="userProfile" style="display: none;">
                <i class="fa-solid fa-user-circle"></i>
                <span id="userEmail"></span>
                <button class="btn btn-secondary btn-sm" id="logoutBtn">
                    <i class="fa-solid fa-sign-out-alt"></i> Logout
                </button>
            </div>
            <button class="theme-toggle" id="themeToggle" aria-label="Toggle theme">
                <i class="fa-solid fa-moon"></i>
            </button>
        </div>
    </nav>

    <!-- Main Container -->
    <main class="main-container">
        <!-- Dashboard View -->
        <section class="view active" id="dashboard">
            <!-- Motivational Quote -->
            <div class="quote-container">
                <i class="fa-solid fa-quote-left"></i>
                <p id="motivationalQuote" class="quote-text">Loading quote...</p>
                <button id="refreshQuoteBtn" class="quote-refresh-btn" title="Get new quote">
                    <i class="fa-solid fa-rotate"></i>
                </button>
            </div>

            <div class="view-header">
                <h1>Today's Tasks</h1>
                <button class="btn btn-primary" id="addTaskBtn">
                    <i class="fa-solid fa-plus"></i>
                    Add Task
                </button>
            </div>

            <!-- Filter Buttons -->
            <div class="filter-container">
                <button class="filter-btn active" data-filter="all">All</button>
                <button class="filter-btn" data-filter="IAP">
                    <span class="priority-badge priority-iap"></span>
                    Important & Urgent
                </button>
                <button class="filter-btn" data-filter="IBNU">
                    <span class="priority-badge priority-ibnu"></span>
                    Important Not Urgent
                </button>
                <button class="filter-btn" data-filter="NIBU">
                    <span class="priority-badge priority-nibu"></span>
                    Not Important Urgent
                </button>
                <button class="filter-btn" data-filter="NINU">
                    <span class="priority-badge priority-ninu"></span>
                    Not Important Not Urgent
                </button>
            </div>

            <!-- Time Blocks -->
            <div class="time-blocks">
                <!-- Morning Block -->
                <div class="time-block">
                    <div class="block-header">
                        <i class="fa-solid fa-sun"></i>
                        <h2>Morning</h2>
                        <span class="time-range">1:00 AM - 12:00 PM</span>
                    </div>
                    <div class="task-list" id="morningTasks">
                        <!-- Tasks will be inserted here -->
                    </div>
                </div>

                <!-- Evening Block -->
                <div class="time-block">
                    <div class="block-header">
                        <i class="fa-solid fa-cloud-sun"></i>
                        <h2>Evening</h2>
                        <span class="time-range">12:00 PM - 6:00 PM</span>
                    </div>
                    <div class="task-list" id="eveningTasks">
                        <!-- Tasks will be inserted here -->
                    </div>
                </div>

                <!-- Night Block -->
                <div class="time-block">
                    <div class="block-header">
                        <i class="fa-solid fa-moon"></i>
                        <h2>Night</h2>
                        <span class="time-range">6:00 PM - 12:00 AM</span>
                    </div>
                    <div class="task-list" id="nightTasks">
                        <!-- Tasks will be inserted here -->
                    </div>
                </div>
            </div>
        </section>

        <!-- Habits View -->
        <section class="view" id="habits">
            <div class="view-header">
                <h1>My Habits</h1>
                <button class="btn btn-primary" id="addHabitBtn">
                    <i class="fa-solid fa-plus"></i>
                    Add Habit
                </button>
            </div>
            <div class="habits-grid" id="habitsGrid">
                <!-- Habit cards will be inserted here -->
            </div>
        </section>

        <!-- Analytics View -->
        <section class="view" id="analytics">
            <div class="view-header">
                <h1>Analytics</h1>
            </div>

            <h2 style="margin-bottom: 1rem; font-size: 1.25rem; color: var(--text-primary);">Task Completion</h2>
            <div class="analytics-container">
                <div class="chart-card">
                    <h3>Weekly Completion Rate</h3>
                    <canvas id="weeklyChart"></canvas>
                </div>
                <div class="chart-card">
                    <h3>Monthly Completion Trend</h3>
                    <canvas id="monthlyChart"></canvas>
                </div>
            </div>

            <!-- Goals Achievement -->
            <h2 style="margin: 2.5rem 0 1rem 0; font-size: 1.25rem; color: var(--text-primary);">Goal Achievement</h2>
            <div style="max-width: 500px; margin: 0 auto;">
                <div class="chart-card">
                    <h3>Goal Completion Rate</h3>
                    <canvas id="goalsChart"></canvas>
                </div>
            </div>

            <!-- Individual Habit Graphs -->
            <h2 style="margin: 2.5rem 0 1rem 0; font-size: 1.25rem; color: var(--text-primary);">Habit Completion
                Patterns</h2>
            <div id="habitChartsContainer"></div>
        </section>

        <!-- Events View -->
        <section class="view" id="events">
            <div class="view-header">
                <h1>Scheduled Events</h1>
                <button class="btn btn-primary" id="addEventBtn">
                    <i class="fa-solid fa-plus"></i>
                    Add Event
                </button>
            </div>
            <div class="events-list" id="eventsList">
                <!-- Event cards will be inserted here -->
            </div>
        </section>

        <!-- Goals View -->
        <section class="view" id="goals">
            <div class="view-header">
                <h1>My Goals</h1>
                <button class="btn btn-primary" id="addGoalBtn">
                    <i class="fa-solid fa-plus"></i>
                    Add Goal
                </button>
            </div>
            <div class="goals-list" id="goalsList">
                <!-- Goal cards will be inserted here -->
            </div>
        </section>
    </main>

    <!-- Right Side Panel (Timer) -->
    <aside class="side-panel" id="timerPanel">
        <div class="panel-header">
            <h2>Focus Timer</h2>
            <button class="close-panel" id="closePanelBtn">
                <i class="fa-solid fa-times"></i>
            </button>
        </div>
        <div class="panel-content">
            <div class="task-info" id="timerTaskInfo">
                <!-- Task details will be shown here -->
            </div>
            <div class="timer-display" id="timerDisplay">00:00:00</div>
            <div class="timer-controls">
                <button class="btn btn-success" id="startTimerBtn">
                    <i class="fa-solid fa-play"></i>
                    Start
                </button>
                <button class="btn btn-warning" id="pauseTimerBtn" style="display: none;">
                    <i class="fa-solid fa-pause"></i>
                    Pause
                </button>
                <button class="btn btn-secondary" id="resetTimerBtn">
                    <i class="fa-solid fa-rotate-left"></i>
                    Reset
                </button>
                <button class="btn btn-info" id="breakTimerBtn">
                    <i class="fa-solid fa-coffee"></i>
                    Take Break
                </button>
            </div>
        </div>
    </aside>

    <!-- Modal for Add/Edit Task -->
    <div class="modal" id="taskModal">
        <div class="modal-content">
            <div class="modal-header">
                <h2 id="taskModalTitle">Add New Task</h2>
                <button class="close-modal">
                    <i class="fa-solid fa-times"></i>
                </button>
            </div>
            <form id="taskForm">
                <div class="form-group">
                    <label for="taskTitle">Task Title*</label>
                    <input type="text" id="taskTitle" required>
                </div>
                <div class="form-group">
                    <label for="taskBlock">Time Block*</label>
                    <select id="taskBlock" required>
                        <option value="morning">Morning (1:00 AM - 12:00 PM)</option>
                        <option value="evening">Evening (12:00 PM - 6:00 PM)</option>
                        <option value="night">Night (6:00 PM - 12:00 AM)</option>
                    </select>
                </div>
                <div class="form-row">
                    <div class="form-group">
                        <label for="taskHours">Hours</label>
                        <input type="number" id="taskHours" min="0" max="23" value="0">
                    </div>
                    <div class="form-group">
                        <label for="taskMinutes">Minutes</label>
                        <input type="number" id="taskMinutes" min="0" max="59" value="30">
                    </div>
                </div>
                <div class="form-group">
                    <label for="taskPriority">Priority*</label>
                    <select id="taskPriority" required>
                        <option value="IAP">Important & Urgent</option>
                        <option value="IBNU">Important but Not Urgent</option>
                        <option value="NIBU">Not Important but Urgent</option>
                        <option value="NINU">Not Important and Not Urgent</option>
                    </select>
                </div>
                <div class="form-group">
                    <label for="taskNotes">Notes</label>
                    <textarea id="taskNotes" rows="3"></textarea>
                </div>
                <div class="form-group">
                    <label>Sub-tasks</label>
                    <div id="subtasksList">
                        <!-- Subtasks will be inserted here -->
                    </div>
                    <button type="button" class="btn btn-secondary" id="addSubtaskBtn">
                        <i class="fa-solid fa-plus"></i>
                        Add Sub-task
                    </button>
                </div>
                <div class="modal-actions">
                    <button type="button" class="btn btn-secondary close-modal">Cancel</button>
                    <button type="submit" class="btn btn-primary">Save Task</button>
                </div>
            </form>
        </div>
    </div>

    <!-- Modal for Add/Edit Habit -->
    <div class="modal" id="habitModal">
        <div class="modal-content">
            <div class="modal-header">
                <h2 id="habitModalTitle">Add New Habit</h2>
                <button class="close-modal">
                    <i class="fa-solid fa-times"></i>
                </button>
            </div>
            <form id="habitForm">
                <div class="form-group">
                    <label for="habitName">Habit Name*</label>
                    <input type="text" id="habitName" required>
                </div>
                <div class="modal-actions">
                    <button type="button" class="btn btn-secondary close-modal">Cancel</button>
                    <button type="submit" class="btn btn-primary">Save Habit</button>
                </div>
            </form>
        </div>
    </div>

    <!-- Modal for Add Event -->
    <div class="modal" id="eventModal">
        <div class="modal-content">
            <div class="modal-header">
                <h2>Add New Event</h2>
                <button class="close-modal">
                    <i class="fa-solid fa-times"></i>
                </button>
            </div>
            <form id="eventForm">
                <div class="form-group">
                    <label for="eventName">Event Name*</label>
                    <input type="text" id="eventName" required>
                </div>
                <div class="form-group">
                    <label for="eventDateTime">Date & Time*</label>
                    <input type="datetime-local" id="eventDateTime" required>
                    <small
                        style="color: var(--text-tertiary); font-size: 0.813rem; margin-top: 0.25rem; display: block;">
                        Click the calendar icon to select a date, or type in format: YYYY-MM-DD HH:MM
                    </small>
                </div>
                <div class="modal-actions">
                    <button type="button" class="btn btn-secondary close-modal">Cancel</button>
                    <button type="submit" class="btn btn-primary">Save Event</button>
                </div>
            </form>
        </div>
    </div>

    <!-- Modal for Break Timer -->
    <div class="modal" id="breakModal">
        <div class="modal-content modal-small">
            <div class="modal-header">
                <h2>Set Break Time</h2>
                <button class="close-modal">
                    <i class="fa-solid fa-times"></i>
                </button>
            </div>
            <form id="breakForm">
                <div class="form-row">
                    <div class="form-group">
                        <label for="breakMinutes">Minutes</label>
                        <input type="number" id="breakMinutes" min="1" max="60" value="5" required>
                    </div>
                </div>
                <div class="modal-actions">
                    <button type="button" class="btn btn-secondary close-modal">Cancel</button>
                    <button type="submit" class="btn btn-primary">Start Break</button>
                </div>
            </form>
        </div>
    </div>

    <!-- Modal for Add/Edit Goal -->
    <div class="modal" id="goalModal">
        <div class="modal-content">
            <div class="modal-header">
                <h2 id="goalModalTitle">Add New Goal</h2>
                <button class="close-modal">
                    <i class="fa-solid fa-times"></i>
                </button>
            </div>
            <form id="goalForm">
                <div class="form-group">
                    <label for="goalTitle">Goal Title*</label>
                    <input type="text" id="goalTitle" required>
                </div>
                <div class="form-group">
                    <label for="goalType">Goal Type*</label>
                    <select id="goalType" required>
                        <option value="weekly">Weekly (7 days)</option>
                        <option value="monthly">Monthly (30 days)</option>
                        <option value="custom">Custom Duration</option>
                    </select>
                </div>
                <div class="form-group" id="customDaysGroup" style="display: none;">
                    <label for="goalCustomDays">Number of Days*</label>
                    <input type="number" id="goalCustomDays" min="1" max="365" value="7">
                </div>
                <div class="modal-actions">
                    <button type="button" class="btn btn-secondary close-modal">Cancel</button>
                    <button type="submit" class="btn btn-primary">Save Goal</button>
                </div>
            </form>
        </div>
    </div>

    <!-- Focus Mode (Full Page Timer) -->
    <div class="focus-mode" id="focusMode">
        <!-- Animated Background -->
        <div class="focus-background">
            <canvas id="focusAnimationCanvas"></canvas>
        </div>

        <!-- Header -->
        <header class="focus-header">
            <button class="focus-back-btn" id="focusBackBtn">
                <i class="fas fa-arrow-left"></i>
                <span>Back</span>
            </button>

            <div class="focus-header-controls">
                <button class="focus-control-btn" id="focusSoundBtn" title="Ambient Sounds">
                    <i class="fas fa-volume-up"></i>
                </button>
                <button class="focus-control-btn" id="focusAnimationBtn" title="Background Animation">
                    <i class="fas fa-palette"></i>
                </button>
            </div>
        </header>

        <!-- Sound Settings Panel -->
        <div class="focus-settings-panel" id="focusSoundPanel">
            <h3 class="focus-panel-title"><i class="fas fa-music"></i> Ambient Sounds</h3>
            <div class="sound-options">
                <button class="sound-option active" data-sound="none">
                    <i class="fas fa-volume-mute"></i> Silence
                </button>
                <button class="sound-option" data-sound="white">
                    <i class="fas fa-broadcast-tower"></i> White Noise
                </button>
                <button class="sound-option" data-sound="brown">
                    <i class="fas fa-wave-square"></i> Brown Noise
                </button>
                <button class="sound-option" data-sound="pink">
                    <i class="fas fa-signal"></i> Pink Noise
                </button>
                <button class="sound-option" data-sound="rain">
                    <i class="fas fa-cloud-rain"></i> Rain
                </button>
                <button class="sound-option" data-sound="fire">
                    <i class="fas fa-fire"></i> Fireplace
                </button>
                <button class="sound-option" data-sound="ocean">
                    <i class="fas fa-water"></i> Ocean Waves
                </button>
                <button class="sound-option" data-sound="forest">
                    <i class="fas fa-tree"></i> Forest
                </button>
            </div>
            <div class="volume-control">
                <label><i class="fas fa-volume-down"></i> Volume</label>
                <input type="range" class="volume-slider" id="focusVolumeSlider" min="0" max="100" value="50">
            </div>
        </div>

        <!-- Animation Settings Panel -->
        <div class="focus-settings-panel" id="focusAnimationPanel">
            <h3 class="focus-panel-title"><i class="fas fa-palette"></i> Background</h3>
            <div class="animation-options">
                <button class="animation-option active" data-animation="stars">
                    <i class="fas fa-star"></i>
                    Starry Night
                </button>
                <button class="animation-option" data-animation="campfire">
                    <i class="fas fa-fire-alt"></i>
                    Campfire
                </button>
                <button class="animation-option" data-animation="rain">
                    <i class="fas fa-cloud-rain"></i>
                    Rain
                </button>
                <button class="animation-option" data-animation="ocean">
                    <i class="fas fa-water"></i>
                    Ocean
                </button>
                <button class="animation-option" data-animation="forest">
                    <i class="fas fa-tree"></i>
                    Forest
                </button>
                <button class="animation-option" data-animation="cozy">
                    <i class="fas fa-couch"></i>
                    Cozy Room
                </button>
            </div>
        </div>

        <!-- Main Content -->
        <main class="focus-content">
            <!-- Task Info -->
            <div class="focus-task-info">
                <h1 class="focus-task-title" id="focusTaskTitle">Focus Session</h1>
                <p class="focus-subtask-title" id="focusSubtaskTitle"></p>
            </div>

            <!-- Timer Display -->
            <div class="focus-timer-container">
                <div class="focus-timer-ring">
                    <svg viewBox="0 0 320 320">
                        <defs>
                            <linearGradient id="timerGradient" x1="0%" y1="0%" x2="100%" y2="100%">
                                <stop offset="0%" style="stop-color:#7c3aed" />
                                <stop offset="100%" style="stop-color:#06b6d4" />
                            </linearGradient>
                        </defs>
                        <circle class="progress-bg" cx="160" cy="160" r="140" />
                        <circle class="progress-bar" cx="160" cy="160" r="140" />
                    </svg>
                    <div class="focus-timer-display">
                        <div class="focus-timer-time" id="focusTimerDisplay">00:00:00</div>
                        <div class="focus-timer-label" id="focusTimerLabel">FOCUS TIME</div>
                    </div>
                </div>
            </div>

            <!-- Timer Controls -->
            <div class="focus-timer-controls">
                <button class="focus-btn focus-btn-primary" id="focusStartBtn">
                    <i class="fas fa-play"></i> Start
                </button>
                <button class="focus-btn focus-btn-secondary" id="focusResetBtn">
                    <i class="fas fa-redo"></i> Reset
                </button>
                <button class="focus-btn focus-btn-break" id="focusBreakBtn">
                    <i class="fas fa-coffee"></i> Break
                </button>
            </div>

            <!-- Break Duration Selector -->
            <div class="break-duration-selector">
                <button class="break-option active" data-minutes="5">5 min</button>
                <button class="break-option" data-minutes="10">10 min</button>
                <button class="break-option" data-minutes="15">15 min</button>
                <button class="break-option" data-minutes="30">30 min</button>
            </div>

            <!-- Quote Section -->
            <div class="focus-quote">
                <p class="focus-quote-text" id="focusQuoteText">"The secret of getting ahead is getting started."</p>
                <p class="focus-quote-author" id="focusQuoteAuthor">â€” Mark Twain</p>
            </div>
        </main>
    </div>

    <!-- Login Modal -->
    <div class="modal" id="loginModal">
        <div class="modal-content">
            <h2>Login to Habit Tracker</h2>
            <form id="loginForm">
                <!-- Google Sign-In -->
                <button type="button" class="btn-google" id="googleLoginBtn">
                    <svg width="20" height="20" viewBox="0 0 24 24">
                        <path fill="#4285F4"
                            d="M22.56 12.25c0-.78-.07-1.53-.2-2.25H12v4.26h5.92c-.26 1.37-1.04 2.53-2.21 3.31v2.77h3.57c2.08-1.92 3.28-4.74 3.28-8.09z" />
                        <path fill="#34A853"
                            d="M12 23c2.97 0 5.46-.98 7.28-2.66l-3.57-2.77c-.98.66-2.23 1.06-3.71 1.06-2.86 0-5.29-1.93-6.16-4.53H2.18v2.84C3.99 20.53 7.7 23 12 23z" />
                        <path fill="#FBBC05"
                            d="M5.84 14.09c-.22-.66-.35-1.36-.35-2.09s.13-1.43.35-2.09V7.07H2.18C1.43 8.55 1 10.22 1 12s.43 3.45 1.18 4.93l2.85-2.22.81-.62z" />
                        <path fill="#EA4335"
                            d="M12 5.38c1.62 0 3.06.56 4.21 1.64l3.15-3.15C17.45 2.09 14.97 1 12 1 7.7 1 3.99 3.47 2.18 7.07l3.66 2.84c.87-2.6 3.3-4.53 6.16-4.53z" />
                    </svg>
                    Continue with Google
                </button>

                <div class="auth-divider"><span>or</span></div>

                <div class="form-group">
                    <label for="loginEmail">Email</label>
                    <input type="email" id="loginEmail" required placeholder="your@email.com">
                </div>
                <div class="form-group">
                    <label for="loginPassword">Password</label>
                    <input type="password" id="loginPassword" required placeholder="Enter your password">
                </div>
                <div class="modal-actions">
                    <button type="submit" class="btn btn-primary">Login</button>
                </div>
            </form>
            <p style="text-align: center; margin-top: 1rem; padding-bottom: 1.5rem; color: var(--text-secondary);">
                Don't have an account? <a href="#" id="showSignupBtn" style="color: var(--primary);">Sign up</a>
            </p>
        </div>
    </div>

    <!-- Signup Modal -->
    <div class="modal" id="signupModal">
        <div class="modal-content">
            <h2>Create Account</h2>
            <form id="signupForm">
                <!-- Google Sign-In -->
                <button type="button" class="btn-google" id="googleSignupBtn">
                    <svg width="20" height="20" viewBox="0 0 24 24">
                        <path fill="#4285F4"
                            d="M22.56 12.25c0-.78-.07-1.53-.2-2.25H12v4.26h5.92c-.26 1.37-1.04 2.53-2.21 3.31v2.77h3.57c2.08-1.92 3.28-4.74 3.28-8.09z" />
                        <path fill="#34A853"
                            d="M12 23c2.97 0 5.46-.98 7.28-2.66l-3.57-2.77c-.98.66-2.23 1.06-3.71 1.06-2.86 0-5.29-1.93-6.16-4.53H2.18v2.84C3.99 20.53 7.7 23 12 23z" />
                        <path fill="#FBBC05"
                            d="M5.84 14.09c-.22-.66-.35-1.36-.35-2.09s.13-1.43.35-2.09V7.07H2.18C1.43 8.55 1 10.22 1 12s.43 3.45 1.18 4.93l2.85-2.22.81-.62z" />
                        <path fill="#EA4335"
                            d="M12 5.38c1.62 0 3.06.56 4.21 1.64l3.15-3.15C17.45 2.09 14.97 1 12 1 7.7 1 3.99 3.47 2.18 7.07l3.66 2.84c.87-2.6 3.3-4.53 6.16-4.53z" />
                    </svg>
                    Continue with Google
                </button>

                <div class="auth-divider"><span>or</span></div>

                <div class="form-group">
                    <label for="signupEmail">Email</label>
                    <input type="email" id="signupEmail" required placeholder="your@email.com">
                </div>
                <div class="form-group">
                    <label for="signupPassword">Password</label>
                    <input type="password" id="signupPassword" required minlength="6"
                        placeholder="At least 6 characters">
                </div>
                <div class="modal-actions">
                    <button type="submit" class="btn btn-primary">Sign Up</button>
                </div>
            </form>
            <p style="text-align: center; margin-top: 1rem; padding-bottom: 1.5rem; color: var(--text-secondary);">
                Already have an account? <a href="#" id="showLoginBtn" style="color: var(--primary);">Login</a>
            </p>
        </div>
    </div>

    <!-- Chart.js -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.0/dist/chart.umd.min.js"></script>

    <!-- App Scripts -->
    <script src="js/storage.js"></script>
    <script src="js/theme.js"></script>
    <script src="js/state.js"></script>
    <script src="js/timer.js"></script>
    <script src="js/tasks.js"></script>
    <script src="js/habits.js"></script>
    <script src="js/events.js"></script>
    <script src="js/goals.js"></script>
    <script src="js/quotes.js"></script>
    <script src="js/analytics.js"></script>
    <script src="js/focus-mode.js"></script>

    <!-- Supabase Integration -->
    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
    <script src="js/supabase.js"></script>
    <script src="js/auth.js"></script>

    <script src="js/app.js"></script>

    <!-- Service Worker Registration -->
    <script>
        if ('serviceWorker' in navigator) {
            window.addEventListener('load', () => {
                navigator.serviceWorker.register('/service-worker.js')
                    .then((registration) => {
                        console.log('Service Worker registered successfully:', registration.scope);

                        // Check for updates
                        registration.addEventListener('updatefound', () => {
                            const newWorker = registration.installing;
                            newWorker.addEventListener('statechange', () => {
                                if (newWorker.state === 'installed' && navigator.serviceWorker.controller) {
                                    // New service worker available, show update notification
                                    if (confirm('New version available! Reload to update?')) {
                                        newWorker.postMessage({ type: 'SKIP_WAITING' });
                                        window.location.reload();
                                    }
                                }
                            });
                        });
                    })
                    .catch((error) => {
                        console.log('Service Worker registration failed:', error);
                    });
            });
        }
    </script>
</body>

</html>