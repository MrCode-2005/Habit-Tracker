<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="A modern habit and daily task tracker with time blocks, streaks, and analytics">

    <!-- PWA Meta Tags -->
    <meta name="theme-color" content="#6366f1">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="apple-mobile-web-app-title" content="Habit Tracker">
    <link rel="manifest" href="/manifest.json">
    <link rel="apple-touch-icon" href="/icon-192.png">

    <!-- Favicon -->
    <link rel="icon" type="image/svg+xml" href="/favicon.svg">
    <link rel="icon" type="image/png" sizes="32x32" href="/icon-192.png">
    <link rel="shortcut icon" href="/favicon.svg">

    <title>Habit & Task Tracker</title>
    <link rel="stylesheet" href="styles/main.css">
    <link rel="stylesheet" href="styles/focus-mode.css">
    <link rel="stylesheet" href="styles/calendar.css">
    <link rel="stylesheet" href="styles/dashboard.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
</head>

<body>
    <!-- Navigation Bar -->
    <nav class="navbar">
        <div class="nav-container">
            <div class="nav-brand">
                <i class="fa-solid fa-check-double"></i>
                <span>Habit Tracker</span>
            </div>

            <!-- Mobile Menu Toggle -->
            <button class="mobile-menu-btn" id="mobileMenuBtn" aria-label="Toggle navigation menu">
                <i class="fa-solid fa-bars"></i>
            </button>

            <div class="nav-links" id="navLinks">
                <button class="nav-btn active" data-view="dashboard">
                    <i class="fa-solid fa-home"></i>
                    <span>Dashboard</span>
                </button>
                <button class="nav-btn" data-view="habits">
                    <i class="fa-solid fa-star"></i>
                    <span>Habits</span>
                </button>
                <button class="nav-btn" data-view="analytics">
                    <i class="fa-solid fa-chart-line"></i>
                    <span>Analytics</span>
                </button>
                <button class="nav-btn" data-view="goals">
                    <i class="fa-solid fa-bullseye"></i>
                    <span>Goals</span>
                </button>
                <button class="nav-btn" data-view="events">
                    <i class="fa-solid fa-calendar-days"></i>
                    <span>Events</span>
                </button>
                <button class="nav-btn" data-view="calendar">
                    <i class="fa-solid fa-calendar"></i>
                    <span>Calendar</span>
                </button>
            </div>
            <div class="user-menu" id="userMenu" style="display: none;">
                <button class="user-menu-btn" id="userMenuBtn">
                    <div class="user-avatar">
                        <i class="fa-solid fa-user"></i>
                    </div>
                    <span class="user-email" id="userEmail"></span>
                    <i class="fa-solid fa-chevron-down user-menu-arrow"></i>
                </button>

                <!-- User Dropdown -->
                <div class="user-dropdown" id="userDropdown">
                    <div class="dropdown-header">
                        <div class="dropdown-avatar">
                            <i class="fa-solid fa-user"></i>
                        </div>
                        <div class="dropdown-user-info">
                            <span class="dropdown-email" id="dropdownEmail"></span>
                            <span class="dropdown-status">Signed in</span>
                        </div>
                    </div>

                    <div class="dropdown-divider"></div>

                    <!-- Account Switcher -->
                    <div class="dropdown-section">
                        <span class="dropdown-section-title">Switch Account</span>
                        <div class="account-list" id="accountList">
                            <!-- Saved accounts will be inserted here -->
                        </div>
                        <button class="dropdown-item" id="addAccountBtn">
                            <i class="fa-solid fa-plus"></i>
                            <span>Add another account</span>
                        </button>
                    </div>

                    <div class="dropdown-divider"></div>

                    <!-- Menu Items -->
                    <button class="dropdown-item" id="clearHistoryBtn">
                        <i class="fa-solid fa-trash-can"></i>
                        <span>Clear History</span>
                    </button>

                    <div class="dropdown-divider"></div>

                    <button class="dropdown-item dropdown-item-danger" id="logoutBtn">
                        <i class="fa-solid fa-sign-out-alt"></i>
                        <span>Logout</span>
                    </button>
                </div>
            </div>
            <button class="theme-toggle" id="themeToggle" aria-label="Toggle theme">
                <i class="fa-solid fa-moon"></i>
            </button>
        </div>
    </nav>

    <!-- Main Container -->
    <main class="main-container">
        <!-- Dashboard View -->
        <section class="view active" id="dashboard">
            <!-- Motivational Quote -->
            <div class="quote-container">
                <i class="fa-solid fa-quote-left"></i>
                <p id="motivationalQuote" class="quote-text">Loading quote...</p>
                <button id="refreshQuoteBtn" class="quote-refresh-btn" title="Get new quote">
                    <i class="fa-solid fa-rotate"></i>
                </button>
            </div>

            <div class="view-header">
                <h1>Today's Tasks</h1>
                <button class="btn btn-primary" id="addTaskBtn">
                    <i class="fa-solid fa-plus"></i>
                    Add Task
                </button>
            </div>

            <!-- Filter Buttons -->
            <div class="filter-container">
                <button class="filter-btn active" data-filter="all">All</button>
                <button class="filter-btn" data-filter="IAP">
                    <span class="priority-badge priority-iap"></span>
                    Important & Urgent
                </button>
                <button class="filter-btn" data-filter="IBNU">
                    <span class="priority-badge priority-ibnu"></span>
                    Important Not Urgent
                </button>
                <button class="filter-btn" data-filter="NIBU">
                    <span class="priority-badge priority-nibu"></span>
                    Not Important Urgent
                </button>
                <button class="filter-btn" data-filter="NINU">
                    <span class="priority-badge priority-ninu"></span>
                    Not Important Not Urgent
                </button>
            </div>

            <!-- Time Blocks -->
            <div class="time-blocks">
                <!-- Morning Block -->
                <div class="time-block">
                    <div class="block-header">
                        <i class="fa-solid fa-sun"></i>
                        <h2>Morning</h2>
                        <span class="time-range">1:00 AM - 12:00 PM</span>
                    </div>
                    <div class="task-list" id="morningTasks">
                        <!-- Tasks will be inserted here -->
                    </div>
                </div>

                <!-- Evening Block -->
                <div class="time-block">
                    <div class="block-header">
                        <i class="fa-solid fa-cloud-sun"></i>
                        <h2>Evening</h2>
                        <span class="time-range">12:00 PM - 6:00 PM</span>
                    </div>
                    <div class="task-list" id="eveningTasks">
                        <!-- Tasks will be inserted here -->
                    </div>
                </div>

                <!-- Night Block -->
                <div class="time-block">
                    <div class="block-header">
                        <i class="fa-solid fa-moon"></i>
                        <h2>Night</h2>
                        <span class="time-range">6:00 PM - 12:00 AM</span>
                    </div>
                    <div class="task-list" id="nightTasks">
                        <!-- Tasks will be inserted here -->
                    </div>
                </div>
            </div>
        </section>

        <!-- Habits View -->
        <section class="view" id="habits">
            <div class="view-header">
                <h1>My Habits</h1>
                <button class="btn btn-primary" id="addHabitBtn">
                    <i class="fa-solid fa-plus"></i>
                    Add Habit
                </button>
            </div>
            <div class="habits-grid" id="habitsGrid">
                <!-- Habit cards will be inserted here -->
            </div>
        </section>

        <!-- Analytics View -->
        <section class="view" id="analytics">
            <div class="view-header">
                <h1>Analytics</h1>
            </div>

            <h2 style="margin-bottom: 1rem; font-size: 1.25rem; color: var(--text-primary);">Task Completion</h2>
            <div class="analytics-container">
                <div class="chart-card">
                    <h3>Weekly Completion Rate</h3>
                    <canvas id="weeklyChart"></canvas>
                </div>
                <div class="chart-card">
                    <h3>Monthly Completion Trend</h3>
                    <canvas id="monthlyChart"></canvas>
                </div>
            </div>

            <!-- Goals Achievement -->
            <h2 style="margin: 2.5rem 0 1rem 0; font-size: 1.25rem; color: var(--text-primary);">Goal Achievement</h2>
            <div style="max-width: 500px; margin: 0 auto;">
                <div class="chart-card">
                    <h3>Goal Completion Rate</h3>
                    <canvas id="goalsChart"></canvas>
                </div>
            </div>

            <!-- Habit Completion Graphs -->
            <h2 style="margin: 2.5rem 0 1rem 0; font-size: 1.25rem; color: var(--text-primary);">Habit Completion
                Patterns</h2>
            <div class="analytics-container" id="habitChartsSection">
                <div class="chart-card">
                    <h3>Weekly Completion Rate</h3>
                    <canvas id="habitWeeklyChart"></canvas>
                </div>
                <div class="chart-card">
                    <h3>Monthly Completion Trend</h3>
                    <canvas id="habitMonthlyChart"></canvas>
                </div>
            </div>

            <!-- Productivity Insights -->
            <h2 style="margin: 2.5rem 0 1rem 0; font-size: 1.25rem; color: var(--text-primary);">Productivity Insights
            </h2>

            <!-- Stats Cards -->
            <div class="productivity-stats" id="productivityStats">
                <div class="stat-card stat-streak">
                    <div class="stat-icon"><i class="fa-solid fa-fire-flame-curved"></i></div>
                    <div class="stat-content">
                        <span class="stat-label">Current Streak</span>
                        <span class="stat-value" id="taskStreak">0 days</span>
                    </div>
                </div>
                <div class="stat-card">
                    <div class="stat-icon"><i class="fa-solid fa-check-double"></i></div>
                    <div class="stat-content">
                        <span class="stat-label">Completed</span>
                        <span class="stat-value" id="totalCompleted">0</span>
                    </div>
                </div>
                <div class="stat-card">
                    <div class="stat-icon"><i class="fa-solid fa-clock"></i></div>
                    <div class="stat-content">
                        <span class="stat-label">Peak Time</span>
                        <span class="stat-value" id="mostProductiveTime">-</span>
                    </div>
                </div>
                <div class="stat-card">
                    <div class="stat-icon"><i class="fa-solid fa-calendar-day"></i></div>
                    <div class="stat-content">
                        <span class="stat-label">Best Day</span>
                        <span class="stat-value" id="mostProductiveDay">-</span>
                    </div>
                </div>
            </div>

            <!-- Compact Charts Row -->
            <div class="analytics-container analytics-compact">
                <div class="chart-card chart-compact">
                    <h3>Time of Day</h3>
                    <canvas id="timeSlotChart"></canvas>
                </div>
                <div class="chart-card chart-compact">
                    <h3>By Block</h3>
                    <canvas id="blockChart"></canvas>
                </div>
            </div>
        </section>

        <!-- Events View (Original - Scheduled Events with Countdown) -->
        <section class="view" id="events">
            <div class="view-header">
                <h1>Scheduled Events</h1>
                <button class="btn btn-primary" id="addEventBtn">
                    <i class="fa-solid fa-plus"></i>
                    Add Event
                </button>
            </div>
            <div class="events-list" id="eventsList">
                <!-- Event cards will be inserted here -->
            </div>
        </section>

        <!-- Calendar View (Separate Page) -->
        <section class="view" id="calendar">
            <div class="view-header">
                <h1>Calendar</h1>
            </div>

            <!-- Calendar Container -->
            <div class="calendar-container">
                <div class="calendar-header">
                    <div class="calendar-nav">
                        <button class="calendar-nav-btn" id="prevMonth" aria-label="Previous month">
                            <i class="fas fa-chevron-left"></i>
                        </button>
                        <button class="calendar-today-btn" id="todayBtn" aria-label="Go to today">
                            Today
                        </button>
                        <button class="calendar-nav-btn" id="nextMonth" aria-label="Next month">
                            <i class="fas fa-chevron-right"></i>
                        </button>
                    </div>
                    <div class="calendar-date-selector" aria-live="polite">
                        <button class="calendar-month-btn" id="monthSelector" aria-label="Select month">
                            <span id="calendarMonth"></span>
                            <i class="fas fa-chevron-down"></i>
                        </button>
                        <button class="calendar-year-btn" id="yearSelector" aria-label="Select year">
                            <span id="calendarYear"></span>
                            <i class="fas fa-chevron-down"></i>
                        </button>
                        <!-- Month Dropdown -->
                        <div class="calendar-dropdown" id="monthDropdown">
                            <div class="dropdown-grid" id="monthOptions">
                                <!-- Month options will be populated by JS -->
                            </div>
                        </div>
                        <!-- Year Dropdown -->
                        <div class="calendar-dropdown" id="yearDropdown">
                            <div class="dropdown-grid year-grid" id="yearOptions">
                                <!-- Year options will be populated by JS -->
                            </div>
                        </div>
                    </div>
                </div>
                <div class="calendar-weekdays" role="row">
                    <div role="columnheader" aria-label="Sunday">Sun</div>
                    <div role="columnheader" aria-label="Monday">Mon</div>
                    <div role="columnheader" aria-label="Tuesday">Tue</div>
                    <div role="columnheader" aria-label="Wednesday">Wed</div>
                    <div role="columnheader" aria-label="Thursday">Thu</div>
                    <div role="columnheader" aria-label="Friday">Fri</div>
                    <div role="columnheader" aria-label="Saturday">Sat</div>
                </div>
                <div class="calendar-days" id="calendarDays" role="grid" aria-label="Calendar days">
                    <!-- Calendar days will be rendered here -->
                </div>
            </div>

            <!-- Upcoming Events Reminder -->
            <div class="upcoming-events">
                <div class="upcoming-header">
                    <h3><i class="fas fa-bell"></i> Upcoming Events</h3>
                    <div class="upcoming-filter">
                        <select id="upcomingFilter" class="upcoming-filter-select"
                            aria-label="Filter events by time range">
                            <option value="7">1 Week</option>
                            <option value="10">10 Days</option>
                            <option value="30" selected>1 Month</option>
                            <option value="180">6 Months</option>
                        </select>
                    </div>
                </div>
                <div class="upcoming-list" id="upcomingEventsList" role="list">
                    <!-- Upcoming events will be shown here -->
                </div>
            </div>
        </section>

        <!-- Calendar Event Modal -->
        <div class="modal" id="calendarEventModal">
            <div class="modal-content">
                <div class="modal-header">
                    <h2 id="calendarEventModalTitle">Add Event</h2>
                    <button class="close-modal" onclick="Calendar.closeModal()"><i class="fas fa-times"></i></button>
                </div>
                <form id="calendarEventForm">
                    <div class="form-group">
                        <label for="eventName">Event Name</label>
                        <input type="text" id="calEventName" required placeholder="Event name...">
                    </div>
                    <div class="form-group">
                        <label for="eventDate">Date</label>
                        <input type="date" id="calEventDate" required>
                    </div>
                    <div class="form-group">
                        <label for="eventTime">Time</label>
                        <input type="time" id="calEventTime">
                    </div>
                    <div class="form-group">
                        <label for="eventLink">Link (optional)</label>
                        <input type="url" id="calEventLink" placeholder="https://...">
                    </div>
                    <div class="form-group">
                        <label for="eventComments">Comments (optional)</label>
                        <textarea id="calEventComments" rows="3" placeholder="Additional notes..."></textarea>
                    </div>
                    <div class="form-actions">
                        <button type="button" class="btn btn-secondary" onclick="Calendar.closeModal()">Cancel</button>
                        <button type="submit" class="btn btn-primary">Save Event</button>
                    </div>
                </form>
            </div>
        </div>

        <!-- Event Details Popup -->
        <div class="event-details-popup" id="eventDetailsPopup">
            <div class="popup-content">
                <button class="close-popup" onclick="Calendar.closeDetails()"><i class="fas fa-times"></i></button>
                <h3 id="detailEventName"></h3>
                <p class="event-time"><i class="fas fa-clock"></i> <span id="detailEventTime"></span></p>
                <p class="event-link" id="detailEventLinkContainer"><i class="fas fa-link"></i> <a id="detailEventLink"
                        href="#" target="_blank"></a></p>
                <p class="event-comments" id="detailEventComments"></p>
                <div class="popup-actions">
                    <button class="btn btn-primary" onclick="Calendar.editEvent()"><i class="fas fa-edit"></i>
                        Edit</button>
                    <button class="btn btn-danger" onclick="Calendar.deleteEvent()"><i class="fas fa-trash"></i>
                        Delete</button>
                </div>
            </div>
        </div>

        <!-- Goals View -->
        <section class="view" id="goals">
            <div class="view-header">
                <h1>My Goals</h1>
                <button class="btn btn-primary" id="addGoalBtn">
                    <i class="fa-solid fa-plus"></i>
                    Add Goal
                </button>
            </div>
            <div class="goals-list" id="goalsList">
                <!-- Goal cards will be inserted here -->
            </div>
        </section>
    </main>

    <!-- Right Side Panel (Timer) -->
    <aside class="side-panel" id="timerPanel">
        <div class="panel-header">
            <h2>Focus Timer</h2>
            <button class="close-panel" id="closePanelBtn">
                <i class="fa-solid fa-times"></i>
            </button>
        </div>
        <div class="panel-content">
            <div class="task-info" id="timerTaskInfo">
                <!-- Task details will be shown here -->
            </div>
            <div class="timer-display" id="timerDisplay">00:00:00</div>
            <div class="timer-controls">
                <button class="btn btn-success" id="startTimerBtn">
                    <i class="fa-solid fa-play"></i>
                    Start
                </button>
                <button class="btn btn-warning" id="pauseTimerBtn" style="display: none;">
                    <i class="fa-solid fa-pause"></i>
                    Pause
                </button>
                <button class="btn btn-secondary" id="resetTimerBtn">
                    <i class="fa-solid fa-rotate-left"></i>
                    Reset
                </button>
                <button class="btn btn-info" id="breakTimerBtn">
                    <i class="fa-solid fa-coffee"></i>
                    Take Break
                </button>
            </div>
        </div>
    </aside>

    <!-- Modal for Add/Edit Task -->
    <div class="modal" id="taskModal">
        <div class="modal-content">
            <div class="modal-header">
                <h2 id="taskModalTitle">Add New Task</h2>
                <button class="close-modal">
                    <i class="fa-solid fa-times"></i>
                </button>
            </div>
            <form id="taskForm">
                <div class="form-group">
                    <label for="taskTitle">Task Title*</label>
                    <input type="text" id="taskTitle" required>
                </div>
                <div class="form-group">
                    <label for="taskBlock">Time Block*</label>
                    <select id="taskBlock" required>
                        <option value="morning">Morning (1:00 AM - 12:00 PM)</option>
                        <option value="evening">Evening (12:00 PM - 6:00 PM)</option>
                        <option value="night">Night (6:00 PM - 12:00 AM)</option>
                    </select>
                </div>
                <div class="form-row">
                    <div class="form-group">
                        <label for="taskHours">Hours</label>
                        <input type="number" id="taskHours" min="0" max="23" value="0">
                    </div>
                    <div class="form-group">
                        <label for="taskMinutes">Minutes</label>
                        <input type="number" id="taskMinutes" min="0" max="59" value="30">
                    </div>
                </div>
                <div class="form-group">
                    <label for="taskPriority">Priority*</label>
                    <select id="taskPriority" required>
                        <option value="IAP">Important & Urgent</option>
                        <option value="IBNU">Important but Not Urgent</option>
                        <option value="NIBU">Not Important but Urgent</option>
                        <option value="NINU">Not Important and Not Urgent</option>
                    </select>
                </div>
                <div class="form-group">
                    <label for="taskNotes">Notes</label>
                    <textarea id="taskNotes" rows="3"></textarea>
                </div>
                <div class="form-group">
                    <label>Sub-tasks</label>
                    <div id="subtasksList">
                        <!-- Subtasks will be inserted here -->
                    </div>
                    <button type="button" class="btn btn-secondary" id="addSubtaskBtn">
                        <i class="fa-solid fa-plus"></i>
                        Add Sub-task
                    </button>
                </div>
                <div class="modal-actions">
                    <button type="button" class="btn btn-secondary close-modal">Cancel</button>
                    <button type="submit" class="btn btn-primary">Save Task</button>
                </div>
            </form>
        </div>
    </div>

    <!-- Modal for Add/Edit Habit -->
    <div class="modal" id="habitModal">
        <div class="modal-content">
            <div class="modal-header">
                <h2 id="habitModalTitle">Add New Habit</h2>
                <button class="close-modal">
                    <i class="fa-solid fa-times"></i>
                </button>
            </div>
            <form id="habitForm">
                <div class="form-group">
                    <label for="habitName">Habit Name*</label>
                    <input type="text" id="habitName" required>
                </div>
                <div class="modal-actions">
                    <button type="button" class="btn btn-secondary close-modal">Cancel</button>
                    <button type="submit" class="btn btn-primary">Save Habit</button>
                </div>
            </form>
        </div>
    </div>

    <!-- Modal for Add Event -->
    <div class="modal" id="eventModal">
        <div class="modal-content">
            <div class="modal-header">
                <h2>Add New Event</h2>
                <button class="close-modal">
                    <i class="fa-solid fa-times"></i>
                </button>
            </div>
            <form id="eventForm">
                <div class="form-group">
                    <label for="eventName">Event Name*</label>
                    <input type="text" id="eventName" required>
                </div>
                <div class="form-group">
                    <label for="eventDateTime">Date & Time*</label>
                    <input type="datetime-local" id="eventDateTime" required>
                    <small
                        style="color: var(--text-tertiary); font-size: 0.813rem; margin-top: 0.25rem; display: block;">
                        Click the calendar icon to select a date, or type in format: YYYY-MM-DD HH:MM
                    </small>
                </div>
                <div class="modal-actions">
                    <button type="button" class="btn btn-secondary close-modal">Cancel</button>
                    <button type="submit" class="btn btn-primary">Save Event</button>
                </div>
            </form>
        </div>
    </div>

    <!-- Modal for Break Timer -->
    <div class="modal" id="breakModal">
        <div class="modal-content modal-small">
            <div class="modal-header">
                <h2>Set Break Time</h2>
                <button class="close-modal">
                    <i class="fa-solid fa-times"></i>
                </button>
            </div>
            <form id="breakForm">
                <div class="form-row">
                    <div class="form-group">
                        <label for="breakMinutes">Minutes</label>
                        <input type="number" id="breakMinutes" min="1" max="60" value="5" required>
                    </div>
                </div>
                <div class="modal-actions">
                    <button type="button" class="btn btn-secondary close-modal">Cancel</button>
                    <button type="submit" class="btn btn-primary">Start Break</button>
                </div>
            </form>
        </div>
    </div>

    <!-- Modal for Add/Edit Goal -->
    <div class="modal" id="goalModal">
        <div class="modal-content">
            <div class="modal-header">
                <h2 id="goalModalTitle">Add New Goal</h2>
                <button class="close-modal">
                    <i class="fa-solid fa-times"></i>
                </button>
            </div>
            <form id="goalForm">
                <div class="form-group">
                    <label for="goalTitle">Goal Title*</label>
                    <input type="text" id="goalTitle" required>
                </div>
                <div class="form-group">
                    <label for="goalType">Goal Type*</label>
                    <select id="goalType" required>
                        <option value="weekly">Weekly (7 days)</option>
                        <option value="monthly">Monthly (30 days)</option>
                        <option value="custom">Custom Duration</option>
                    </select>
                </div>
                <div class="form-group" id="customDaysGroup" style="display: none;">
                    <label for="goalCustomDays">Number of Days*</label>
                    <input type="number" id="goalCustomDays" min="1" max="365" value="7">
                </div>
                <div class="modal-actions">
                    <button type="button" class="btn btn-secondary close-modal">Cancel</button>
                    <button type="submit" class="btn btn-primary">Save Goal</button>
                </div>
            </form>
        </div>
    </div>

    <!-- Focus Mode (Full Page Timer) -->
    <div class="focus-mode" id="focusMode">
        <!-- Animated Background -->
        <div class="focus-background">
            <canvas id="focusAnimationCanvas"></canvas>
            <video id="videoBgPlayer" class="video-bg-player" muted loop playsinline></video>
            <!-- YouTube Video Background (visible) -->
            <div class="youtube-video-bg" id="youtubeVideoBg"></div>
        </div>

        <!-- Hidden YouTube Audio Player -->
        <div class="youtube-iframe-container" id="youtubeContainer"></div>

        <!-- Header -->
        <header class="focus-header">
            <button class="focus-back-btn" id="focusBackBtn">
                <i class="fas fa-arrow-left"></i>
                <span>Back</span>
            </button>

            <div class="focus-header-controls">
                <button class="focus-control-btn" id="focusSoundBtn" title="Ambient Sounds">
                    <i class="fas fa-volume-up"></i>
                </button>
                <button class="focus-control-btn" id="focusAnimationBtn" title="Background Animation">
                    <i class="fas fa-palette"></i>
                </button>
            </div>
        </header>

        <!-- Sound Settings Panel -->
        <div class="focus-settings-panel" id="focusSoundPanel">
            <div class="panel-header">
                <h3 class="focus-panel-title"><i class="fas fa-music"></i> Ambient Sounds</h3>
                <button class="panel-expand-btn" id="expandSoundPanel" title="Expand/Collapse">
                    <i class="fas fa-expand-alt"></i>
                </button>
            </div>
            <div class="sound-options">
                <button class="sound-option active" data-sound="none">
                    <i class="fas fa-volume-mute"></i> Silence
                </button>
                <button class="sound-option" data-sound="white">
                    <i class="fas fa-broadcast-tower"></i> White Noise
                </button>
                <button class="sound-option" data-sound="brown">
                    <i class="fas fa-wave-square"></i> Brown Noise
                </button>
                <button class="sound-option" data-sound="pink">
                    <i class="fas fa-signal"></i> Pink Noise
                </button>
                <button class="sound-option" data-sound="rain">
                    <i class="fas fa-cloud-rain"></i> Rain
                </button>
                <button class="sound-option" data-sound="fire">
                    <i class="fas fa-fire"></i> Fireplace
                </button>
                <button class="sound-option" data-sound="ocean">
                    <i class="fas fa-water"></i> Ocean Waves
                </button>
                <button class="sound-option" data-sound="forest">
                    <i class="fas fa-tree"></i> Forest
                </button>
            </div>
            <!-- Custom Sound Upload -->
            <div class="custom-sound-upload">
                <label class="sound-option" id="customSoundLabel">
                    <i class="fas fa-upload"></i> Upload Custom
                    <input type="file" id="customSoundInput" accept="audio/*" style="display: none;">
                </label>
                <span class="custom-sound-name" id="customSoundName"></span>
            </div>
            <!-- YouTube URL Input -->
            <div class="youtube-sound-input">
                <label class="youtube-label"><i class="fab fa-youtube"></i> YouTube URL</label>
                <div class="youtube-input-row">
                    <input type="text" id="youtubeUrlInput" placeholder="Paste YouTube URL here..."
                        class="youtube-url-field">
                    <button id="youtubePlayBtn" class="youtube-play-btn"><i class="fas fa-play"></i></button>
                    <button id="youtubeAddBtn" class="youtube-add-btn" title="Add to Playlist"><i
                            class="fas fa-plus"></i></button>
                </div>
                <span class="youtube-status" id="youtubeStatus"></span>
            </div>
            <!-- YouTube Playlist -->
            <div class="youtube-playlist">
                <div class="playlist-header">
                    <label class="youtube-label"><i class="fas fa-list-ul"></i> My Playlists</label>
                    <button id="newPlaylistBtn" class="playlist-new-btn" title="New Playlist"><i
                            class="fas fa-folder-plus"></i></button>
                </div>
                <select id="playlistSelect" class="playlist-select">
                    <option value="">-- Select Playlist --</option>
                </select>
                <div class="playlist-tracks" id="playlistTracks">
                    <!-- Tracks will be populated here -->
                </div>
                <div class="playlist-controls">
                    <button id="playPlaylistBtn" class="playlist-play-btn"><i class="fas fa-play"></i> Play All</button>
                    <button id="shufflePlaylistBtn" class="playlist-shuffle-btn"><i class="fas fa-random"></i></button>
                </div>
            </div>
            <div class="volume-control">
                <label><i class="fas fa-volume-down"></i> Volume</label>
                <input type="range" class="volume-slider" id="focusVolumeSlider" min="0" max="100" value="50">
            </div>

            <!-- Audio Playback Controls -->
            <div class="audio-playback-section">
                <label class="section-label"><i class="fas fa-music"></i> Playback Controls</label>
                <div class="audio-timeline">
                    <span class="audio-time" id="audioCurrentTime">0:00</span>
                    <input type="range" class="audio-progress" id="audioProgress" min="0" max="100" value="0">
                    <span class="audio-time" id="audioDuration">0:00</span>
                </div>
                <!-- Main playback controls -->
                <div class="audio-main-controls">
                    <button class="control-btn" id="audioPrevTrack" title="Previous Track"><i
                            class="fas fa-step-backward"></i></button>
                    <button class="control-btn play-pause-btn" id="audioPlayPause" title="Pause"><i
                            class="fas fa-pause"></i></button>
                    <button class="control-btn" id="audioNextTrack" title="Next Track"><i
                            class="fas fa-step-forward"></i></button>
                </div>
                <!-- Skip controls -->
                <div class="audio-skip-controls">
                    <button class="skip-btn" id="skipBack10" title="Back 10s"><i class="fas fa-backward"></i>
                        10</button>
                    <button class="skip-btn" id="skipBack5" title="Back 5s"><i class="fas fa-backward"></i> 5</button>
                    <button class="skip-btn" id="skipForward5" title="Forward 5s">5 <i
                            class="fas fa-forward"></i></button>
                    <button class="skip-btn" id="skipForward10" title="Forward 10s">10 <i
                            class="fas fa-forward"></i></button>
                </div>
            </div>

            <!-- Video Background Section -->
            <div class="video-bg-section">
                <label class="section-label"><i class="fas fa-film"></i> Video Background</label>
                <div class="video-input-row">
                    <input type="text" id="videoBgUrl" placeholder="YouTube URL..." class="video-url-input">
                    <button id="setVideoBgBtn" class="video-set-btn"><i class="fas fa-check"></i></button>
                </div>
                <div class="video-upload-row">
                    <label for="videoBgUpload" class="video-upload-btn">
                        <i class="fas fa-upload"></i> Upload Video
                    </label>
                    <input type="file" id="videoBgUpload" accept="video/*" hidden>
                    <button id="clearVideoBgBtn" class="video-clear-btn"><i class="fas fa-times"></i> Clear</button>
                </div>

                <!-- Video Playlist -->
                <div class="video-playlist-section">
                    <div class="playlist-header">
                        <label><i class="fas fa-list-ul"></i> Video Playlists</label>
                        <button id="newVideoPlaylistBtn" class="playlist-new-btn" title="New Playlist"><i
                                class="fas fa-folder-plus"></i></button>
                    </div>
                    <div class="playlist-name-row">
                        <select id="videoPlaylistSelect" class="playlist-select">
                            <option value="">-- Select Playlist --</option>
                        </select>
                        <button id="editVideoPlaylistNameBtn" class="edit-name-btn" title="Rename"><i
                                class="fas fa-edit"></i></button>
                    </div>
                    <div class="video-playlist-input">
                        <input type="text" id="videoPlaylistUrl" placeholder="Add YouTube URL..."
                            class="video-url-input">
                        <button id="addVideoToPlaylistBtn" class="video-set-btn"><i class="fas fa-plus"></i></button>
                    </div>
                    <div class="video-playlist-tracks" id="videoPlaylistTracks">
                        <!-- Video tracks will be populated here -->
                    </div>
                    <div class="playlist-controls">
                        <button id="playVideoPlaylistBtn" class="playlist-play-btn"><i class="fas fa-play"></i> Play
                            All</button>
                        <button id="shuffleVideoPlaylistBtn" class="playlist-shuffle-btn"><i
                                class="fas fa-random"></i></button>
                    </div>
                </div>
            </div>

            <!-- Interval Alert Section -->
            <div class="interval-alert-section">
                <label class="section-label"><i class="fas fa-bell"></i> Interval Alerts</label>
                <div class="interval-enable-row">
                    <label class="toggle-label">
                        <input type="checkbox" id="enableIntervalAlert">
                        <span>Enable reminder alerts</span>
                    </label>
                </div>
                <div class="interval-settings" id="intervalSettings">
                    <div class="interval-time-row">
                        <label>Alert every:</label>
                        <input type="number" id="intervalMinutes" min="1" max="60" value="15" class="interval-input">
                        <span>minutes</span>
                    </div>
                    <div class="alert-sound-row">
                        <label>Alert sound:</label>
                        <select id="alertSoundSelect" class="alert-sound-select">
                            <option value="chime">üîî Chime</option>
                            <option value="bell">üõéÔ∏è Bell</option>
                            <option value="gong">üéµ Gong</option>
                            <option value="water">üíß Water Drop</option>
                            <option value="bird">üê¶ Bird Chirp</option>
                            <option value="bowl">ü•£ Singing Bowl</option>
                        </select>
                    </div>
                    <button id="testAlertBtn" class="test-alert-btn"><i class="fas fa-play"></i> Test Sound</button>
                </div>
            </div>
        </div>

        <!-- Animation Settings Panel -->
        <div class="focus-settings-panel" id="focusAnimationPanel">
            <h3 class="focus-panel-title"><i class="fas fa-palette"></i> Background</h3>
            <div class="animation-options">
                <button class="animation-option active" data-animation="stars">
                    <i class="fas fa-star"></i>
                    Starry Night
                </button>
                <button class="animation-option" data-animation="campfire">
                    <i class="fas fa-fire-alt"></i>
                    Campfire
                </button>
                <button class="animation-option" data-animation="rain">
                    <i class="fas fa-cloud-rain"></i>
                    Rain
                </button>
                <button class="animation-option" data-animation="ocean">
                    <i class="fas fa-water"></i>
                    Ocean
                </button>
                <button class="animation-option" data-animation="forest">
                    <i class="fas fa-tree"></i>
                    Forest
                </button>
                <button class="animation-option" data-animation="cozy">
                    <i class="fas fa-couch"></i>
                    Cozy Room
                </button>
                <button class="animation-option" data-animation="aurora">
                    <i class="fas fa-rainbow"></i>
                    Aurora
                </button>
                <button class="animation-option" data-animation="snow">
                    <i class="fas fa-snowflake"></i>
                    Snowfall
                </button>
                <button class="animation-option" data-animation="sunset">
                    <i class="fas fa-sun"></i>
                    Sunset
                </button>
                <button class="animation-option" data-animation="cherry">
                    <i class="fas fa-leaf"></i>
                    Cherry Blossoms
                </button>
                <button class="animation-option" data-animation="underwater">
                    <i class="fas fa-fish"></i>
                    Underwater
                </button>
                <button class="animation-option" data-animation="candle">
                    <i class="fas fa-lightbulb"></i>
                    Candlelight
                </button>
                <button class="animation-option" data-animation="thunder">
                    <i class="fas fa-bolt"></i>
                    Thunderstorm
                </button>
                <button class="animation-option" data-animation="galaxy">
                    <i class="fas fa-meteor"></i>
                    Galaxy
                </button>
                <button class="animation-option" data-animation="zen">
                    <i class="fas fa-spa"></i>
                    Zen Garden
                </button>
                <button class="animation-option" data-animation="meadow">
                    <i class="fas fa-seedling"></i>
                    Meadow
                </button>
            </div>
        </div>

        <!-- Main Content -->
        <main class="focus-content">
            <!-- Task Info -->
            <div class="focus-task-info">
                <h1 class="focus-task-title" id="focusTaskTitle">Focus Session</h1>
                <p class="focus-subtask-title" id="focusSubtaskTitle"></p>
                <div class="focus-subtask-nav" id="focusSubtaskNav">
                    <button class="subtask-nav-btn" id="prevSubtaskBtn" title="Previous Subtask">
                        <i class="fas fa-chevron-left"></i>
                    </button>
                    <div class="focus-task-progress" id="focusTaskProgress">
                        <!-- Task progress will be shown here -->
                    </div>
                    <button class="subtask-nav-btn" id="nextSubtaskBtn" title="Next Subtask">
                        <i class="fas fa-chevron-right"></i>
                    </button>
                </div>
                <!-- Subtask Comment/Link Display -->
                <div class="focus-subtask-details" id="focusSubtaskDetails">
                    <p class="focus-subtask-comment" id="focusSubtaskComment"></p>
                    <a class="focus-subtask-link" id="focusSubtaskLink" href="#" target="_blank"></a>
                </div>
            </div>

            <!-- Timer Display -->
            <div class="focus-timer-container">
                <div class="focus-timer-ring">
                    <svg viewBox="0 0 320 320">
                        <defs>
                            <linearGradient id="timerGradient" x1="0%" y1="0%" x2="100%" y2="100%">
                                <stop offset="0%" style="stop-color:#7c3aed" />
                                <stop offset="100%" style="stop-color:#06b6d4" />
                            </linearGradient>
                        </defs>
                        <circle class="progress-bg" cx="160" cy="160" r="140" />
                        <circle class="progress-bar" cx="160" cy="160" r="140" />
                    </svg>
                    <div class="focus-timer-display">
                        <div class="focus-timer-time" id="focusTimerDisplay">00:00:00</div>
                        <div class="focus-timer-label" id="focusTimerLabel">FOCUS TIME</div>
                    </div>
                </div>
            </div>

            <!-- Timer Controls -->
            <div class="focus-timer-controls">
                <button class="focus-btn focus-btn-primary" id="focusStartBtn">
                    <i class="fas fa-play"></i> Start
                </button>
                <button class="focus-btn focus-btn-secondary" id="focusResetBtn">
                    <i class="fas fa-redo"></i> Reset
                </button>
                <button class="focus-btn focus-btn-break" id="focusBreakBtn">
                    <i class="fas fa-coffee"></i> Break
                </button>
            </div>

            <!-- Break Duration Selector -->
            <div class="break-duration-selector">
                <button class="break-option active" data-minutes="5">5 min</button>
                <button class="break-option" data-minutes="10">10 min</button>
                <button class="break-option" data-minutes="15">15 min</button>
                <button class="break-option" data-minutes="30">30 min</button>
            </div>

            <!-- Quote Section -->
            <div class="focus-quote">
                <p class="focus-quote-text" id="focusQuoteText">"The secret of getting ahead is getting started."</p>
                <p class="focus-quote-author" id="focusQuoteAuthor">‚Äî Mark Twain</p>
            </div>
        </main>

        <!-- Floating Toggle Button for Audio Panel -->
        <button class="audio-panel-toggle-btn" id="toggleAudioPanelBtn" title="Toggle Audio Controls">
            <i class="fas fa-music"></i>
        </button>

        <!-- Right Side Audio Panel (Toggleable) -->
        <aside class="focus-audio-panel hidden" id="focusAudioPanel">
            <div class="audio-panel-header">
                <h3><i class="fas fa-music"></i> Audio Controls</h3>
                <button class="audio-panel-hide-btn" id="hideAudioPanelBtn" title="Hide"><i
                        class="fas fa-chevron-right"></i></button>
            </div>

            <!-- Playlist Section -->
            <div class="audio-panel-section">
                <div class="playlist-header-mini">
                    <label><i class="fas fa-list-ul"></i> My Playlists</label>
                    <button class="playlist-new-btn-mini" id="newPlaylistBtnMini" title="New Playlist"><i
                            class="fas fa-plus"></i></button>
                </div>
                <select class="playlist-select-mini" id="playlistSelectMini">
                    <option value="">-- Select Playlist --</option>
                </select>
                <div class="playlist-tracks-mini" id="playlistTracksMini">
                    <!-- Tracks populated here -->
                </div>
                <div class="playlist-controls-mini">
                    <button class="playlist-play-btn-mini" id="playAllBtnMini"><i class="fas fa-play"></i> Play
                        All</button>
                    <button class="playlist-shuffle-btn-mini" id="shuffleBtnMini"><i class="fas fa-random"></i></button>
                </div>
            </div>

            <!-- Volume Control -->
            <div class="audio-panel-section">
                <label><i class="fas fa-volume-down"></i> Volume</label>
                <input type="range" class="volume-slider-mini" id="volumeSliderMini" min="0" max="100" value="50">
            </div>

            <!-- Playback Controls -->
            <div class="audio-panel-section">
                <label><i class="fas fa-music"></i> Playback</label>
                <div class="audio-timeline-mini">
                    <span class="audio-time-mini" id="audioTimeMini">0:00</span>
                    <input type="range" class="audio-progress-mini" id="audioProgressMini" min="0" max="100" value="0">
                    <span class="audio-time-mini" id="audioDurationMini">0:00</span>
                </div>
                <div class="audio-main-controls-mini">
                    <button class="control-btn-mini" id="prevTrackMini"><i class="fas fa-step-backward"></i></button>
                    <button class="control-btn-mini play-pause-btn-mini" id="playPauseMini"><i
                            class="fas fa-pause"></i></button>
                    <button class="control-btn-mini" id="nextTrackMini"><i class="fas fa-step-forward"></i></button>
                </div>
                <div class="audio-skip-controls-mini">
                    <button class="skip-btn-mini" id="skipBack10Mini"><i class="fas fa-backward"></i> 10</button>
                    <button class="skip-btn-mini" id="skipBack5Mini"><i class="fas fa-backward"></i> 5</button>
                    <button class="skip-btn-mini" id="skipForward5Mini">5 <i class="fas fa-forward"></i></button>
                    <button class="skip-btn-mini" id="skipForward10Mini">10 <i class="fas fa-forward"></i></button>
                </div>
            </div>
        </aside>
    </div>

    <!-- Login Modal -->
    <div class="modal" id="loginModal">
        <div class="modal-content">
            <h2>Login to Habit Tracker</h2>
            <form id="loginForm">
                <!-- Google Sign-In -->
                <button type="button" class="btn-google" id="googleLoginBtn">
                    <svg width="20" height="20" viewBox="0 0 24 24">
                        <path fill="#4285F4"
                            d="M22.56 12.25c0-.78-.07-1.53-.2-2.25H12v4.26h5.92c-.26 1.37-1.04 2.53-2.21 3.31v2.77h3.57c2.08-1.92 3.28-4.74 3.28-8.09z" />
                        <path fill="#34A853"
                            d="M12 23c2.97 0 5.46-.98 7.28-2.66l-3.57-2.77c-.98.66-2.23 1.06-3.71 1.06-2.86 0-5.29-1.93-6.16-4.53H2.18v2.84C3.99 20.53 7.7 23 12 23z" />
                        <path fill="#FBBC05"
                            d="M5.84 14.09c-.22-.66-.35-1.36-.35-2.09s.13-1.43.35-2.09V7.07H2.18C1.43 8.55 1 10.22 1 12s.43 3.45 1.18 4.93l2.85-2.22.81-.62z" />
                        <path fill="#EA4335"
                            d="M12 5.38c1.62 0 3.06.56 4.21 1.64l3.15-3.15C17.45 2.09 14.97 1 12 1 7.7 1 3.99 3.47 2.18 7.07l3.66 2.84c.87-2.6 3.3-4.53 6.16-4.53z" />
                    </svg>
                    Continue with Google
                </button>

                <div class="auth-divider"><span>or</span></div>

                <div class="form-group">
                    <label for="loginEmail">Email</label>
                    <input type="email" id="loginEmail" required placeholder="your@email.com">
                </div>
                <div class="form-group">
                    <label for="loginPassword">Password</label>
                    <input type="password" id="loginPassword" required placeholder="Enter your password">
                </div>
                <div class="modal-actions">
                    <button type="submit" class="btn btn-primary">Login</button>
                </div>
            </form>
            <p style="text-align: center; margin-top: 1rem; padding-bottom: 1.5rem; color: var(--text-secondary);">
                Don't have an account? <a href="#" id="showSignupBtn" style="color: var(--primary);">Sign up</a>
            </p>
        </div>
    </div>

    <!-- Signup Modal -->
    <div class="modal" id="signupModal">
        <div class="modal-content">
            <h2>Create Account</h2>
            <form id="signupForm">
                <!-- Google Sign-In -->
                <button type="button" class="btn-google" id="googleSignupBtn">
                    <svg width="20" height="20" viewBox="0 0 24 24">
                        <path fill="#4285F4"
                            d="M22.56 12.25c0-.78-.07-1.53-.2-2.25H12v4.26h5.92c-.26 1.37-1.04 2.53-2.21 3.31v2.77h3.57c2.08-1.92 3.28-4.74 3.28-8.09z" />
                        <path fill="#34A853"
                            d="M12 23c2.97 0 5.46-.98 7.28-2.66l-3.57-2.77c-.98.66-2.23 1.06-3.71 1.06-2.86 0-5.29-1.93-6.16-4.53H2.18v2.84C3.99 20.53 7.7 23 12 23z" />
                        <path fill="#FBBC05"
                            d="M5.84 14.09c-.22-.66-.35-1.36-.35-2.09s.13-1.43.35-2.09V7.07H2.18C1.43 8.55 1 10.22 1 12s.43 3.45 1.18 4.93l2.85-2.22.81-.62z" />
                        <path fill="#EA4335"
                            d="M12 5.38c1.62 0 3.06.56 4.21 1.64l3.15-3.15C17.45 2.09 14.97 1 12 1 7.7 1 3.99 3.47 2.18 7.07l3.66 2.84c.87-2.6 3.3-4.53 6.16-4.53z" />
                    </svg>
                    Continue with Google
                </button>

                <div class="auth-divider"><span>or</span></div>

                <div class="form-group">
                    <label for="signupEmail">Email</label>
                    <input type="email" id="signupEmail" required placeholder="your@email.com">
                </div>
                <div class="form-group">
                    <label for="signupPassword">Password</label>
                    <input type="password" id="signupPassword" required minlength="6"
                        placeholder="At least 6 characters">
                </div>
                <div class="modal-actions">
                    <button type="submit" class="btn btn-primary">Sign Up</button>
                </div>
            </form>
            <p style="text-align: center; margin-top: 1rem; padding-bottom: 1.5rem; color: var(--text-secondary);">
                Already have an account? <a href="#" id="showLoginBtn" style="color: var(--primary);">Login</a>
            </p>
        </div>
    </div>

    <!-- Logout Confirmation Modal -->
    <div class="modal" id="logoutConfirmModal">
        <div class="modal-content modal-small">
            <div class="modal-header">
                <h2>Confirm Logout</h2>
                <button class="close-modal"
                    onclick="document.getElementById('logoutConfirmModal').classList.remove('active')">
                    <i class="fa-solid fa-times"></i>
                </button>
            </div>
            <div class="modal-body" style="padding: 1.5rem;">
                <p style="text-align: center; color: var(--text-secondary); margin-bottom: 1.5rem;">
                    <i class="fa-solid fa-sign-out-alt"
                        style="font-size: 2rem; color: var(--warning); display: block; margin-bottom: 1rem;"></i>
                    Are you sure you want to logout?
                </p>
                <div class="modal-actions" style="display: flex; gap: 1rem; justify-content: center;">
                    <button class="btn btn-secondary"
                        onclick="document.getElementById('logoutConfirmModal').classList.remove('active')">Cancel</button>
                    <button class="btn btn-danger" id="confirmLogoutBtn">Yes, Logout</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Clear History Modal -->
    <div class="modal" id="clearHistoryModal">
        <div class="modal-content" style="max-width: 700px;">
            <div class="modal-header">
                <h2><i class="fa-solid fa-trash-can" style="margin-right: 0.5rem;"></i> Clear History</h2>
                <button class="close-modal"
                    onclick="document.getElementById('clearHistoryModal').classList.remove('active')">
                    <i class="fa-solid fa-times"></i>
                </button>
            </div>
            <div class="modal-body" style="padding: 1.5rem;">
                <p style="color: var(--text-secondary); margin-bottom: 1.5rem;">
                    Select the type of data and time range you want to clear. This action cannot be undone.
                </p>

                <!-- Data Type Tabs -->
                <div class="history-tabs" style="display: flex; gap: 0.5rem; margin-bottom: 1.5rem;">
                    <button class="history-tab active" data-type="tasks" onclick="ClearHistory.selectTab('tasks')">
                        <i class="fa-solid fa-list-check"></i> Tasks
                    </button>
                    <button class="history-tab" data-type="habits" onclick="ClearHistory.selectTab('habits')">
                        <i class="fa-solid fa-star"></i> Habits
                    </button>
                    <button class="history-tab" data-type="goals" onclick="ClearHistory.selectTab('goals')">
                        <i class="fa-solid fa-bullseye"></i> Goals
                    </button>
                </div>

                <!-- Time Range Options -->
                <div class="form-group">
                    <label>Select Time Range</label>
                    <div class="time-range-options">
                        <label class="radio-option">
                            <input type="radio" name="timeRange" value="3" checked>
                            <span>Last 3 days</span>
                        </label>
                        <label class="radio-option">
                            <input type="radio" name="timeRange" value="7">
                            <span>Last 1 week</span>
                        </label>
                        <label class="radio-option">
                            <input type="radio" name="timeRange" value="30">
                            <span>Last 1 month</span>
                        </label>
                        <label class="radio-option">
                            <input type="radio" name="timeRange" value="custom">
                            <span>Custom range</span>
                        </label>
                    </div>
                </div>

                <!-- Custom Range Input -->
                <div class="form-group" id="customRangeGroup" style="display: none;">
                    <label for="customDays">Number of days</label>
                    <input type="number" id="customDays" min="1" max="365" placeholder="Enter number of days">
                </div>

                <!-- Preview -->
                <div class="history-preview" id="historyPreview"
                    style="background: var(--bg-tertiary); border-radius: 12px; padding: 1rem; margin: 1rem 0;">
                    <div class="preview-header"
                        style="display: flex; justify-content: space-between; margin-bottom: 0.5rem;">
                        <span style="font-weight: 600;">Items to be cleared:</span>
                        <span id="previewCount" style="color: var(--danger);">0 items</span>
                    </div>
                    <p id="previewText" style="color: var(--text-tertiary); font-size: 0.875rem;"></p>
                </div>

                <!-- Warning -->
                <div
                    style="background: rgba(239, 68, 68, 0.1); border: 1px solid rgba(239, 68, 68, 0.2); border-radius: 12px; padding: 1rem; margin-bottom: 1rem;">
                    <p style="color: var(--danger); font-size: 0.875rem;">
                        <i class="fa-solid fa-exclamation-triangle" style="margin-right: 0.5rem;"></i>
                        <strong>Warning:</strong> This will permanently delete both active items and completion history
                        for the selected range.
                    </p>
                </div>

                <div class="modal-actions" style="display: flex; gap: 1rem; justify-content: flex-end;">
                    <button class="btn btn-secondary"
                        onclick="document.getElementById('clearHistoryModal').classList.remove('active')">Cancel</button>
                    <button class="btn btn-danger" id="confirmClearBtn" onclick="ClearHistory.clearData()">
                        <i class="fa-solid fa-trash"></i> Clear Data
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- Chart.js -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.0/dist/chart.umd.min.js"></script>

    <!-- App Scripts -->
    <script src="js/storage.js"></script>
    <script src="js/theme.js"></script>
    <script src="js/state.js"></script>
    <script src="js/timer.js"></script>
    <script src="js/tasks.js"></script>
    <script src="js/habits.js"></script>
    <script src="js/events.js"></script>
    <script src="js/goals.js"></script>
    <script src="js/quotes.js"></script>
    <script src="js/analytics.js"></script>
    <script src="js/focus-mode.js"></script>
    <script src="js/calendar.js"></script>

    <!-- Supabase Integration -->
    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
    <script src="js/supabase.js"></script>
    <script src="js/auth.js"></script>
    <script src="js/user-menu.js"></script>

    <script src="js/app.js"></script>

    <!-- Service Worker Registration -->
    <script>
        if ('serviceWorker' in navigator) {
            window.addEventListener('load', () => {
                navigator.serviceWorker.register('/service-worker.js')
                    .then((registration) => {
                        console.log('Service Worker registered successfully:', registration.scope);

                        // Check for updates
                        registration.addEventListener('updatefound', () => {
                            const newWorker = registration.installing;
                            newWorker.addEventListener('statechange', () => {
                                if (newWorker.state === 'installed' && navigator.serviceWorker.controller) {
                                    // New service worker available, show update notification
                                    if (confirm('New version available! Reload to update?')) {
                                        newWorker.postMessage({ type: 'SKIP_WAITING' });
                                        window.location.reload();
                                    }
                                }
                            });
                        });
                    })
                    .catch((error) => {
                        console.log('Service Worker registration failed:', error);
                    });
            });
        }
    </script>
</body>

</html>